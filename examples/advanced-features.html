<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My OpenLayers - é«˜çº§åŠŸèƒ½ç¤ºä¾‹</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .map-container {
            width: 100%;
            height: 600px;
            border: 1px solid #ccc;
            margin-bottom: 20px;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .control-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .control-group label {
            font-weight: bold;
            font-size: 14px;
        }
        
        button {
            padding: 8px 16px;
            background-color: #409EFF;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        button:hover {
            background-color: #337ecc;
        }
        
        button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }
        
        .log-container {
            background-color: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 15px;
            height: 200px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 12px;
        }
        
        .log-entry {
            margin-bottom: 5px;
            padding: 2px 0;
        }
        
        .log-error {
            color: #e74c3c;
        }
        
        .log-info {
            color: #3498db;
        }
        
        .log-success {
            color: #27ae60;
        }
        
        .status-bar {
            background-color: #2c3e50;
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .status-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>My OpenLayers - é«˜çº§åŠŸèƒ½ç¤ºä¾‹</h1>
        
        <div class="status-bar">
            <div class="status-item">
                <span>ğŸ—ºï¸ åœ°å›¾çŠ¶æ€:</span>
                <span id="mapStatus">æœªåˆå§‹åŒ–</span>
            </div>
            <div class="status-item">
                <span>ğŸ“ åæ ‡:</span>
                <span id="coordinates">-</span>
            </div>
            <div class="status-item">
                <span>ğŸ” ç¼©æ”¾:</span>
                <span id="zoomLevel">-</span>
            </div>
            <div class="status-item">
                <span>ğŸ“¡ äº‹ä»¶ç›‘å¬å™¨:</span>
                <span id="listenerCount">0</span>
            </div>
        </div>
        
        <div class="controls">
            <div class="control-group">
                <label>åŸºç¡€æ“ä½œ</label>
                <button onclick="initMap()">åˆå§‹åŒ–åœ°å›¾</button>
                <button onclick="addSampleData()">æ·»åŠ ç¤ºä¾‹æ•°æ®</button>
                <button onclick="clearMap()">æ¸…ç©ºåœ°å›¾</button>
            </div>
            
            <div class="control-group">
                <label>äº‹ä»¶ç®¡ç†</label>
                <button onclick="addClickListener()">æ·»åŠ ç‚¹å‡»ç›‘å¬</button>
                <button onclick="addHoverListener()">æ·»åŠ æ‚¬åœç›‘å¬</button>
                <button onclick="addZoomListener()">æ·»åŠ ç¼©æ”¾ç›‘å¬</button>
                <button onclick="removeAllListeners()">ç§»é™¤æ‰€æœ‰ç›‘å¬</button>
            </div>
            
            <div class="control-group">
                <label>é”™è¯¯æµ‹è¯•</label>
                <button onclick="testValidation()">æµ‹è¯•éªŒè¯</button>
                <button onclick="testErrorHandling()">æµ‹è¯•é”™è¯¯å¤„ç†</button>
                <button onclick="triggerError()">è§¦å‘é”™è¯¯</button>
            </div>
            
            <div class="control-group">
                <label>é…ç½®ç®¡ç†</label>
                <button onclick="testConfigManager()">æµ‹è¯•é…ç½®ç®¡ç†</button>
                <button onclick="showDefaultConfigs()">æ˜¾ç¤ºé»˜è®¤é…ç½®</button>
            </div>
        </div>
        
        <div id="mapContainer" class="map-container"></div>
        
        <h3>æ—¥å¿—è¾“å‡º</h3>
        <div id="logContainer" class="log-container"></div>
        
        <button onclick="clearLog()" style="margin-top: 10px;">æ¸…ç©ºæ—¥å¿—</button>
    </div>

    <script type="module">
        // è¿™é‡Œåº”è¯¥å¯¼å…¥å®é™…çš„åº“
        // import { MyOl, EventManager, ErrorHandler, ConfigManager } from '../dist/index.js'
        
        // æ¨¡æ‹Ÿåº“çš„åŠŸèƒ½ï¼ˆå®é™…ä½¿ç”¨æ—¶è¯·å¯¼å…¥çœŸå®çš„åº“ï¼‰
        let myOl = null;
        let eventManager = null;
        let map = null;
        
        // æ—¥å¿—åŠŸèƒ½
        function log(message, type = 'info') {
            const logContainer = document.getElementById('logContainer');
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            logEntry.textContent = `[${timestamp}] ${message}`;
            logContainer.appendChild(logEntry);
            logContainer.scrollTop = logContainer.scrollHeight;
        }
        
        function clearLog() {
            document.getElementById('logContainer').innerHTML = '';
        }
        
        function updateStatus() {
            document.getElementById('mapStatus').textContent = myOl ? 'å·²åˆå§‹åŒ–' : 'æœªåˆå§‹åŒ–';
            if (eventManager) {
                const listenerInfo = eventManager.getListenersInfo ? eventManager.getListenersInfo() : [];
                document.getElementById('listenerCount').textContent = listenerInfo.length;
            }
        }
        
        // å…¨å±€å‡½æ•°
        window.initMap = function() {
            try {
                log('æ­£åœ¨åˆå§‹åŒ–åœ°å›¾...', 'info');
                
                // è¿™é‡Œåº”è¯¥æ˜¯å®é™…çš„åœ°å›¾åˆå§‹åŒ–ä»£ç 
                // myOl = new MyOl('mapContainer', {
                //     center: [116.4074, 39.9042],
                //     zoom: 10
                // });
                
                // æ¨¡æ‹Ÿåˆå§‹åŒ–
                myOl = {
                    map: { /* æ¨¡æ‹Ÿåœ°å›¾å¯¹è±¡ */ },
                    point: { /* æ¨¡æ‹Ÿç‚¹ä½æ“ä½œ */ },
                    line: { /* æ¨¡æ‹Ÿçº¿æ“ä½œ */ },
                    polygon: { /* æ¨¡æ‹Ÿé¢æ“ä½œ */ }
                };
                
                // eventManager = new EventManager(myOl.map);
                
                log('åœ°å›¾åˆå§‹åŒ–æˆåŠŸï¼', 'success');
                updateStatus();
                
            } catch (error) {
                log(`åœ°å›¾åˆå§‹åŒ–å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.addSampleData = function() {
            if (!myOl) {
                log('è¯·å…ˆåˆå§‹åŒ–åœ°å›¾', 'error');
                return;
            }
            
            try {
                log('æ­£åœ¨æ·»åŠ ç¤ºä¾‹æ•°æ®...', 'info');
                
                // æ¨¡æ‹Ÿæ·»åŠ æ•°æ®
                log('æ·»åŠ äº†ç¤ºä¾‹ç‚¹ä½æ•°æ®', 'success');
                log('æ·»åŠ äº†ç¤ºä¾‹çº¿æ•°æ®', 'success');
                log('æ·»åŠ äº†ç¤ºä¾‹é¢æ•°æ®', 'success');
                
            } catch (error) {
                log(`æ·»åŠ æ•°æ®å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.clearMap = function() {
            if (!myOl) {
                log('åœ°å›¾æœªåˆå§‹åŒ–', 'error');
                return;
            }
            
            try {
                log('æ­£åœ¨æ¸…ç©ºåœ°å›¾...', 'info');
                // å®é™…æ¸…ç©ºæ“ä½œ
                log('åœ°å›¾å·²æ¸…ç©º', 'success');
            } catch (error) {
                log(`æ¸…ç©ºåœ°å›¾å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.addClickListener = function() {
            if (!eventManager) {
                log('äº‹ä»¶ç®¡ç†å™¨æœªåˆå§‹åŒ–', 'error');
                return;
            }
            
            try {
                // const listenerId = eventManager.on('click', (eventData) => {
                //     log(`ç‚¹å‡»ä½ç½®: ${eventData.coordinate}`, 'info');
                //     if (eventData.feature) {
                //         log(`ç‚¹å‡»è¦ç´ : ${eventData.feature.get('name') || 'æœªå‘½å'}`, 'info');
                //     }
                // });
                
                log('å·²æ·»åŠ ç‚¹å‡»äº‹ä»¶ç›‘å¬å™¨', 'success');
                updateStatus();
            } catch (error) {
                log(`æ·»åŠ ç‚¹å‡»ç›‘å¬å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.addHoverListener = function() {
            if (!eventManager) {
                log('äº‹ä»¶ç®¡ç†å™¨æœªåˆå§‹åŒ–', 'error');
                return;
            }
            
            try {
                log('å·²æ·»åŠ æ‚¬åœäº‹ä»¶ç›‘å¬å™¨', 'success');
                updateStatus();
            } catch (error) {
                log(`æ·»åŠ æ‚¬åœç›‘å¬å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.addZoomListener = function() {
            if (!eventManager) {
                log('äº‹ä»¶ç®¡ç†å™¨æœªåˆå§‹åŒ–', 'error');
                return;
            }
            
            try {
                log('å·²æ·»åŠ ç¼©æ”¾äº‹ä»¶ç›‘å¬å™¨', 'success');
                updateStatus();
            } catch (error) {
                log(`æ·»åŠ ç¼©æ”¾ç›‘å¬å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.removeAllListeners = function() {
            if (!eventManager) {
                log('äº‹ä»¶ç®¡ç†å™¨æœªåˆå§‹åŒ–', 'error');
                return;
            }
            
            try {
                // eventManager.clear();
                log('å·²ç§»é™¤æ‰€æœ‰äº‹ä»¶ç›‘å¬å™¨', 'success');
                updateStatus();
            } catch (error) {
                log(`ç§»é™¤ç›‘å¬å™¨å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.testValidation = function() {
            try {
                log('æµ‹è¯•åæ ‡éªŒè¯...', 'info');
                
                // æ¨¡æ‹ŸéªŒè¯æµ‹è¯•
                log('âœ“ æœ‰æ•ˆåæ ‡ (116.4, 39.9) éªŒè¯é€šè¿‡', 'success');
                log('âœ— æ— æ•ˆåæ ‡ (200, 100) éªŒè¯å¤±è´¥', 'error');
                log('âœ“ æœ‰æ•ˆé¢œè‰² "#ff0000" éªŒè¯é€šè¿‡', 'success');
                log('âœ— æ— æ•ˆé¢œè‰² "invalid" éªŒè¯å¤±è´¥', 'error');
                
            } catch (error) {
                log(`éªŒè¯æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.testErrorHandling = function() {
            try {
                log('æµ‹è¯•é”™è¯¯å¤„ç†æœºåˆ¶...', 'info');
                
                // æ¨¡æ‹Ÿé”™è¯¯å¤„ç†æµ‹è¯•
                log('âœ“ é”™è¯¯å›è°ƒæœºåˆ¶æ­£å¸¸', 'success');
                log('âœ“ é”™è¯¯æ—¥å¿—è®°å½•æ­£å¸¸', 'success');
                log('âœ“ é”™è¯¯ç±»å‹åˆ†ç±»æ­£å¸¸', 'success');
                
            } catch (error) {
                log(`é”™è¯¯å¤„ç†æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.triggerError = function() {
            try {
                log('æ•…æ„è§¦å‘ä¸€ä¸ªé”™è¯¯...', 'info');
                throw new Error('è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•é”™è¯¯');
            } catch (error) {
                log(`æ•è·åˆ°é”™è¯¯: ${error.message}`, 'error');
            }
        };
        
        window.testConfigManager = function() {
            try {
                log('æµ‹è¯•é…ç½®ç®¡ç†å™¨...', 'info');
                
                // æ¨¡æ‹Ÿé…ç½®ç®¡ç†æµ‹è¯•
                log('âœ“ é»˜è®¤é…ç½®åŠ è½½æˆåŠŸ', 'success');
                log('âœ“ é…ç½®åˆå¹¶åŠŸèƒ½æ­£å¸¸', 'success');
                log('âœ“ é…ç½®éªŒè¯åŠŸèƒ½æ­£å¸¸', 'success');
                log('âœ“ IDç”ŸæˆåŠŸèƒ½æ­£å¸¸', 'success');
                
            } catch (error) {
                log(`é…ç½®ç®¡ç†æµ‹è¯•å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        window.showDefaultConfigs = function() {
            try {
                log('æ˜¾ç¤ºé»˜è®¤é…ç½®...', 'info');
                
                // æ¨¡æ‹Ÿæ˜¾ç¤ºé»˜è®¤é…ç½®
                log('ç‚¹ä½é»˜è®¤é…ç½®: strokeColor: #409EFF, strokeWidth: 2', 'info');
                log('çº¿é»˜è®¤é…ç½®: strokeColor: #409EFF, strokeWidth: 2', 'info');
                log('é¢é»˜è®¤é…ç½®: fillColor: rgba(255,255,255,0.3)', 'info');
                log('å›¾ç‰‡é»˜è®¤é…ç½®: opacity: 1, visible: true', 'info');
                
            } catch (error) {
                log(`æ˜¾ç¤ºé…ç½®å¤±è´¥: ${error.message}`, 'error');
            }
        };
        
        // åˆå§‹åŒ–çŠ¶æ€
        updateStatus();
        log('é¡µé¢åŠ è½½å®Œæˆï¼Œè¯·ç‚¹å‡»"åˆå§‹åŒ–åœ°å›¾"å¼€å§‹', 'info');
    </script>
</body>
</html>